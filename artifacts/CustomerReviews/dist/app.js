!function(e){var t={};function r(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(o,i,function(t){return e[t]}.bind(null,i));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r(1),r(2),r(3),r(4),r(5),e.exports=r(6)},function(e,t){void 0!==AppDependencies&&AppDependencies.push("CustomerReviews"),angular.module("CustomerReviews",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("workspace.customerReviews",{url:"/customerReviews",templateUrl:"$(Platform)/Scripts/common/templates/home.tpl.html",controller:["$scope","platformWebApp.bladeNavigationService",function(e,t){t.showBlade({id:"reviewsList",controller:"CustomerReviews.reviewsListController",template:"Modules/$(CustomerReviews)/Scripts/blades/reviews-list.tpl.html",isClosingDisabled:!1})}]})}]).run(["platformWebApp.mainMenuService","platformWebApp.widgetService","$state",function(e,t,r){var o={path:"browse/customerReviews",icon:"fa fa-comments",title:"Customer Reviews",priority:100,action:function(){r.go("workspace.customerReviews")},permission:"customerReview:read"};e.addMenuItem(o);t.registerWidget({controller:"CustomerReviews.customerReviewWidgetController",template:"Modules/$(CustomerReviews)/Scripts/widgets/customerReviewWidget.tpl.html"},"itemDetail");t.registerWidget({controller:"CustomerReviews.customerReviewPositiveWidgetController",template:"Modules/$(CustomerReviews)/Scripts/widgets/customerReviewPositiveWidget.tpl.html"},"itemDetail")}])},function(e,t){angular.module("CustomerReviews").controller("CustomerReviews.reviewsListController",["$scope","CustomerReviews.api","platformWebApp.bladeUtils","uiGridConstants","platformWebApp.uiGridHelper",function(e,t,r,o,i){e.uiGridConstants=o;var n=e.blade;r.bladeNavigationService;n.getSearchCriteria=function(){return angular.extend(s,{searchPhrase:s.keyword?s.keyword:void 0,sort:i.getSortExpression(e),skip:(e.pageSettings.currentPage-1)*e.pageSettings.itemsPerPageCount,take:e.pageSettings.itemsPerPageCount})},n.refresh=function(){n.isLoading=!0,t.search(n.getSearchCriteria(),(function(t){n.isLoading=!1,e.pageSettings.totalItems=t.totalCount,n.currentEntities=t.results}))},n.selectNode=function(e){},n.headIcon="fa-comments",n.toolbarCommands=[{name:"platform.commands.refresh",icon:"fa fa-refresh",executeMethod:n.refresh,canExecuteMethod:function(){return!0}}];var s=e.filter=n.filter||{};s.criteriaChanged=function(){e.pageSettings.currentPage>1?e.pageSettings.currentPage=1:n.refresh()},e.setGridOptions=function(t){i.initialize(e,t,(function(t){i.bindRefreshOnSortChanged(e)})),r.initializePagination(e.$parent)}}])},function(e,t){angular.module("CustomerReviews").factory("CustomerReviews.api",["$resource",function(e){return e("api/customerReviews",{},{search:{method:"POST",url:"api/customerReviews/search"},update:{method:"PUT"}})}])},function(e,t){angular.module("CustomerReviews").controller("CustomerReviews.customerReviewPositiveWidgetController",["$scope","CustomerReviews.api","platformWebApp.bladeNavigationService",function(e,t,r){var o=e.blade,i={take:0,minStars:3};e.openBlade=function(){if(!e.loading&&e.totalCount){var t={id:"reviewsList",filter:i,title:'Customer reviews for "'+o.title+'"',controller:"CustomerReviews.reviewsListController",template:"Modules/$(CustomerReviews)/Scripts/blades/reviews-list.tpl.html"};r.showBlade(t,o)}},e.$watch("blade.itemId",(function(r){i.productIds=[r],r&&(e.loading=!0,t.search(i,(function(t){e.loading=!1,e.totalCount=t.totalCount})))}))}])},function(e,t){angular.module("CustomerReviews").controller("CustomerReviews.customerReviewWidgetController",["$scope","CustomerReviews.api","platformWebApp.bladeNavigationService",function(e,t,r){var o=e.blade,i={take:0};e.openBlade=function(){if(!e.loading&&e.totalCount){var t={id:"reviewsList",filter:i,title:'Customer reviews for "'+o.title+'"',controller:"CustomerReviews.reviewsListController",template:"Modules/$(CustomerReviews)/Scripts/blades/reviews-list.tpl.html"};r.showBlade(t,o)}},e.$watch("blade.itemId",(function(r){i.productIds=[r],r&&(e.loading=!0,t.search(i,(function(t){e.loading=!1,e.totalCount=t.totalCount})))}))}])},function(e,t,r){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9DdXN0b21lclJldmlld3Mvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQ3VzdG9tZXJSZXZpZXdzLy4vU2NyaXB0cy9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vQ3VzdG9tZXJSZXZpZXdzLy4vU2NyaXB0cy9ibGFkZXMvcmV2aWV3cy1saXN0LmpzIiwid2VicGFjazovL0N1c3RvbWVyUmV2aWV3cy8uL1NjcmlwdHMvcmVzb3VyY2VzL0N1c3RvbWVyUmV2aWV3cy5XZWJBcGkuanMiLCJ3ZWJwYWNrOi8vQ3VzdG9tZXJSZXZpZXdzLy4vU2NyaXB0cy93aWRnZXRzL2N1c3RvbWVyUmV2aWV3UG9zaXRpdmVXaWRnZXQuanMiLCJ3ZWJwYWNrOi8vQ3VzdG9tZXJSZXZpZXdzLy4vU2NyaXB0cy93aWRnZXRzL2N1c3RvbWVyUmV2aWV3V2lkZ2V0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidW5kZWZpbmVkIiwiQXBwRGVwZW5kZW5jaWVzIiwicHVzaCIsImFuZ3VsYXIiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiYmxhZGVOYXZpZ2F0aW9uU2VydmljZSIsInNob3dCbGFkZSIsImlkIiwidGVtcGxhdGUiLCJpc0Nsb3NpbmdEaXNhYmxlZCIsInJ1biIsIm1haW5NZW51U2VydmljZSIsIndpZGdldFNlcnZpY2UiLCIkc3RhdGUiLCJtZW51SXRlbSIsInBhdGgiLCJpY29uIiwidGl0bGUiLCJwcmlvcml0eSIsImFjdGlvbiIsImdvIiwicGVybWlzc2lvbiIsImFkZE1lbnVJdGVtIiwicmVnaXN0ZXJXaWRnZXQiLCJyZXZpZXdzQXBpIiwiYmxhZGVVdGlscyIsInVpR3JpZENvbnN0YW50cyIsInVpR3JpZEhlbHBlciIsImJsYWRlIiwiZ2V0U2VhcmNoQ3JpdGVyaWEiLCJleHRlbmQiLCJmaWx0ZXIiLCJzZWFyY2hQaHJhc2UiLCJrZXl3b3JkIiwic29ydCIsImdldFNvcnRFeHByZXNzaW9uIiwic2tpcCIsInBhZ2VTZXR0aW5ncyIsImN1cnJlbnRQYWdlIiwiaXRlbXNQZXJQYWdlQ291bnQiLCJ0YWtlIiwicmVmcmVzaCIsImlzTG9hZGluZyIsInNlYXJjaCIsImRhdGEiLCJ0b3RhbEl0ZW1zIiwidG90YWxDb3VudCIsImN1cnJlbnRFbnRpdGllcyIsInJlc3VsdHMiLCJzZWxlY3ROb2RlIiwiaGVhZEljb24iLCJ0b29sYmFyQ29tbWFuZHMiLCJleGVjdXRlTWV0aG9kIiwiY2FuRXhlY3V0ZU1ldGhvZCIsImNyaXRlcmlhQ2hhbmdlZCIsInNldEdyaWRPcHRpb25zIiwiZ3JpZE9wdGlvbnMiLCJpbml0aWFsaXplIiwiZ3JpZEFwaSIsImJpbmRSZWZyZXNoT25Tb3J0Q2hhbmdlZCIsImluaXRpYWxpemVQYWdpbmF0aW9uIiwiJHBhcmVudCIsImZhY3RvcnkiLCIkcmVzb3VyY2UiLCJtZXRob2QiLCJ1cGRhdGUiLCJtaW5TdGFycyIsIm9wZW5CbGFkZSIsImxvYWRpbmciLCJuZXdCbGFkZSIsIiR3YXRjaCIsInByb2R1Y3RJZHMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIs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QUFnQixTQUFVL0QsR0FDcEN3QixFQUFPd0MsV0FBYSxDQUFDaEUsR0FFakJBLElBeEJKSCxFQUFPZ0UsU0FBVSxFQUNqQjVDLEVBQVdtQixPQUFPWixHQUFRLFNBQVVhLEdBQ2hDeEMsRUFBT2dFLFNBQVUsRUFDakJoRSxFQUFPMEMsV0FBYUYsRUFBS0Usc0IiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLy9DYWxsIHRoaXMgdG8gcmVnaXN0ZXIgb3VyIG1vZHVsZSB0byBtYWluIGFwcGxpY2F0aW9uXG52YXIgbW9kdWxlVGVtcGxhdGVOYW1lID0gXCJDdXN0b21lclJldmlld3NcIjtcblxuaWYgKEFwcERlcGVuZGVuY2llcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgQXBwRGVwZW5kZW5jaWVzLnB1c2gobW9kdWxlVGVtcGxhdGVOYW1lKTtcbn1cblxuYW5ndWxhci5tb2R1bGUobW9kdWxlVGVtcGxhdGVOYW1lLCBbXSlcbi5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLFxuICAgIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ3dvcmtzcGFjZS5jdXN0b21lclJldmlld3MnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2N1c3RvbWVyUmV2aWV3cycsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICckKFBsYXRmb3JtKS9TY3JpcHRzL2NvbW1vbi90ZW1wbGF0ZXMvaG9tZS50cGwuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogW1xuICAgICAgICAgICAgICAgICAgICAnJHNjb3BlJywgJ3BsYXRmb3JtV2ViQXBwLmJsYWRlTmF2aWdhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCBibGFkZU5hdmlnYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3QmxhZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdyZXZpZXdzTGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0N1c3RvbWVyUmV2aWV3cy5yZXZpZXdzTGlzdENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKEN1c3RvbWVyUmV2aWV3cykvU2NyaXB0cy9ibGFkZXMvcmV2aWV3cy1saXN0LnRwbC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0Nsb3NpbmdEaXNhYmxlZDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5dKVxuLnJ1bihbJ3BsYXRmb3JtV2ViQXBwLm1haW5NZW51U2VydmljZScsICdwbGF0Zm9ybVdlYkFwcC53aWRnZXRTZXJ2aWNlJywgJyRzdGF0ZScsXG4gICAgZnVuY3Rpb24gKG1haW5NZW51U2VydmljZSwgd2lkZ2V0U2VydmljZSwgJHN0YXRlKSB7XG4gICAgICAgIC8vUmVnaXN0ZXIgbW9kdWxlIGluIG1haW4gbWVudVxuICAgICAgICB2YXIgbWVudUl0ZW0gPSB7XG4gICAgICAgICAgICBwYXRoOiAnYnJvd3NlL2N1c3RvbWVyUmV2aWV3cycsXG4gICAgICAgICAgICBpY29uOiAnZmEgZmEtY29tbWVudHMnLFxuICAgICAgICAgICAgdGl0bGU6ICdDdXN0b21lciBSZXZpZXdzJyxcbiAgICAgICAgICAgIHByaW9yaXR5OiAxMDAsXG4gICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uICgpIHsgJHN0YXRlLmdvKCd3b3Jrc3BhY2UuY3VzdG9tZXJSZXZpZXdzJykgfSxcbiAgICAgICAgICAgIHBlcm1pc3Npb246ICdjdXN0b21lclJldmlldzpyZWFkJ1xuICAgICAgICB9O1xuICAgICAgICBtYWluTWVudVNlcnZpY2UuYWRkTWVudUl0ZW0obWVudUl0ZW0pO1xuXG4gICAgICAgIC8vUmVnaXN0ZXIgcmV2aWV3cyB3aWRnZXQgaW5zaWRlIHByb2R1Y3QgYmxhZGVcbiAgICAgICAgdmFyIGl0ZW1SZXZpZXdzV2lkZ2V0ID0ge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0N1c3RvbWVyUmV2aWV3cy5jdXN0b21lclJldmlld1dpZGdldENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoQ3VzdG9tZXJSZXZpZXdzKS9TY3JpcHRzL3dpZGdldHMvY3VzdG9tZXJSZXZpZXdXaWRnZXQudHBsLmh0bWwnXG4gICAgICAgIH07XG4gICAgICAgIHdpZGdldFNlcnZpY2UucmVnaXN0ZXJXaWRnZXQoaXRlbVJldmlld3NXaWRnZXQsICdpdGVtRGV0YWlsJyk7XG5cbiAgICAgICAgLy9SZWdpc3RlciBwb3NpdGl2ZSByZXZpZXdzIHdpZGdldCBpbnNpZGUgcHJvZHVjdCBibGFkZVxuICAgICAgICB2YXIgaXRlbVJldmlld3NQb3NpdGl2ZVdpZGdldCA9IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDdXN0b21lclJldmlld3MuY3VzdG9tZXJSZXZpZXdQb3NpdGl2ZVdpZGdldENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoQ3VzdG9tZXJSZXZpZXdzKS9TY3JpcHRzL3dpZGdldHMvY3VzdG9tZXJSZXZpZXdQb3NpdGl2ZVdpZGdldC50cGwuaHRtbCdcbiAgICAgICAgfTtcbiAgICAgICAgd2lkZ2V0U2VydmljZS5yZWdpc3RlcldpZGdldChpdGVtUmV2aWV3c1Bvc2l0aXZlV2lkZ2V0LCAnaXRlbURldGFpbCcpO1xuICAgIH1cbl0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0N1c3RvbWVyUmV2aWV3cycpXG4gICAgLmNvbnRyb2xsZXIoJ0N1c3RvbWVyUmV2aWV3cy5yZXZpZXdzTGlzdENvbnRyb2xsZXInLCBbJyRzY29wZScsICdDdXN0b21lclJldmlld3MuYXBpJywgJ3BsYXRmb3JtV2ViQXBwLmJsYWRlVXRpbHMnLCAndWlHcmlkQ29uc3RhbnRzJywgJ3BsYXRmb3JtV2ViQXBwLnVpR3JpZEhlbHBlcicsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsIHJldmlld3NBcGksIGJsYWRlVXRpbHMsIHVpR3JpZENvbnN0YW50cywgdWlHcmlkSGVscGVyKSB7XG4gICAgICAgICAgICAkc2NvcGUudWlHcmlkQ29uc3RhbnRzID0gdWlHcmlkQ29uc3RhbnRzO1xuXG4gICAgICAgICAgICB2YXIgYmxhZGUgPSAkc2NvcGUuYmxhZGU7XG4gICAgICAgICAgICB2YXIgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSA9IGJsYWRlVXRpbHMuYmxhZGVOYXZpZ2F0aW9uU2VydmljZTtcblxuICAgICAgICAgICAgYmxhZGUuZ2V0U2VhcmNoQ3JpdGVyaWEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZXh0ZW5kKGZpbHRlciwge1xuICAgICAgICAgICAgICAgICAgICBzZWFyY2hQaHJhc2U6IGZpbHRlci5rZXl3b3JkID8gZmlsdGVyLmtleXdvcmQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIHNvcnQ6IHVpR3JpZEhlbHBlci5nZXRTb3J0RXhwcmVzc2lvbigkc2NvcGUpLFxuICAgICAgICAgICAgICAgICAgICBza2lwOiAoJHNjb3BlLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSAtIDEpICogJHNjb3BlLnBhZ2VTZXR0aW5ncy5pdGVtc1BlclBhZ2VDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZTogJHNjb3BlLnBhZ2VTZXR0aW5ncy5pdGVtc1BlclBhZ2VDb3VudFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYmxhZGUucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldmlld3NBcGkuc2VhcmNoKGJsYWRlLmdldFNlYXJjaENyaXRlcmlhKCksIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGFnZVNldHRpbmdzLnRvdGFsSXRlbXMgPSBkYXRhLnRvdGFsQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLmN1cnJlbnRFbnRpdGllcyA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGJsYWRlLnNlbGVjdE5vZGUgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vJHNjb3BlLnNlbGVjdGVkTm9kZUlkID0gZGF0YS5pZDtcblxuICAgICAgICAgICAgICAgIC8vdmFyIG5ld0JsYWRlID0ge1xuICAgICAgICAgICAgICAgIC8vICAgIGlkOiAncmV2aWV3RGV0YWlscycsXG4gICAgICAgICAgICAgICAgLy8gICAgY3VycmVudEVudGl0eUlkOiBkYXRhLmlkLFxuICAgICAgICAgICAgICAgIC8vICAgIGN1cnJlbnRFbnRpdHk6IGRhdGEsXG4gICAgICAgICAgICAgICAgLy8gICAgdGl0bGU6IGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICAvLyAgICBjb250cm9sbGVyOiAndmlydG9Db21tZXJjZS5zdG9yZU1vZHVsZS5zdG9yZURldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIC8vICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuU3RvcmUpL1NjcmlwdHMvYmxhZGVzL3N0b3JlLWRldGFpbC50cGwuaHRtbCdcbiAgICAgICAgICAgICAgICAvL307XG4gICAgICAgICAgICAgICAgLy9ibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy9mdW5jdGlvbiBvcGVuQmxhZGVOZXcoKSB7XG4gICAgICAgICAgICAvLyAgICAkc2NvcGUuc2VsZWN0ZWROb2RlSWQgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyAgICB2YXIgbmV3QmxhZGUgPSB7XG4gICAgICAgICAgICAvLyAgICAgICAgaWQ6ICdzdG9yZURldGFpbHMnLFxuICAgICAgICAgICAgLy8gICAgICAgIGN1cnJlbnRFbnRpdHk6IHt9LFxuICAgICAgICAgICAgLy8gICAgICAgIHRpdGxlOiAnc3RvcmVzLmJsYWRlcy5uZXctc3RvcmUtd2l6YXJkLnRpdGxlJyxcbiAgICAgICAgICAgIC8vICAgICAgICBzdWJ0aXRsZTogJ3N0b3Jlcy5ibGFkZXMubmV3LXN0b3JlLXdpemFyZC5zdWJ0aXRsZScsXG4gICAgICAgICAgICAvLyAgICAgICAgY29udHJvbGxlcjogJ3ZpcnRvQ29tbWVyY2Uuc3RvcmVNb2R1bGUubmV3U3RvcmVXaXphcmRDb250cm9sbGVyJyxcbiAgICAgICAgICAgIC8vICAgICAgICB0ZW1wbGF0ZTogJ01vZHVsZXMvJChWaXJ0b0NvbW1lcmNlLlN0b3JlKS9TY3JpcHRzL3dpemFyZHMvbmV3U3RvcmUvbmV3LXN0b3JlLXdpemFyZC50cGwuaHRtbCdcbiAgICAgICAgICAgIC8vICAgIH07XG4gICAgICAgICAgICAvLyAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUpO1xuICAgICAgICAgICAgLy99XG5cbiAgICAgICAgICAgIGJsYWRlLmhlYWRJY29uID0gJ2ZhLWNvbW1lbnRzJztcblxuICAgICAgICAgICAgYmxhZGUudG9vbGJhckNvbW1hbmRzID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJwbGF0Zm9ybS5jb21tYW5kcy5yZWZyZXNoXCIsIGljb246ICdmYSBmYS1yZWZyZXNoJyxcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZU1ldGhvZDogYmxhZGUucmVmcmVzaCxcbiAgICAgICAgICAgICAgICAgICAgY2FuRXhlY3V0ZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy97XG4gICAgICAgICAgICAgICAgLy8gICAgbmFtZTogXCJwbGF0Zm9ybS5jb21tYW5kcy5hZGRcIiwgaWNvbjogJ2ZhIGZhLXBsdXMnLFxuICAgICAgICAgICAgICAgIC8vICAgIGV4ZWN1dGVNZXRob2Q6IG9wZW5CbGFkZU5ldyxcbiAgICAgICAgICAgICAgICAvLyAgICBjYW5FeGVjdXRlTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIC8vICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gICAgcGVybWlzc2lvbjogJ3N0b3JlOmNyZWF0ZSdcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIC8vIHNpbXBsZSBhbmQgYWR2YW5jZWQgZmlsdGVyaW5nXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gJHNjb3BlLmZpbHRlciA9IGJsYWRlLmZpbHRlciB8fCB7fTtcblxuICAgICAgICAgICAgZmlsdGVyLmNyaXRlcmlhQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSA9IDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmxhZGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIHVpLWdyaWRcbiAgICAgICAgICAgICRzY29wZS5zZXRHcmlkT3B0aW9ucyA9IGZ1bmN0aW9uIChncmlkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHVpR3JpZEhlbHBlci5pbml0aWFsaXplKCRzY29wZSwgZ3JpZE9wdGlvbnMsIGZ1bmN0aW9uIChncmlkQXBpKSB7XG4gICAgICAgICAgICAgICAgICAgIHVpR3JpZEhlbHBlci5iaW5kUmVmcmVzaE9uU29ydENoYW5nZWQoJHNjb3BlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBibGFkZVV0aWxzLmluaXRpYWxpemVQYWdpbmF0aW9uKCRzY29wZS4kcGFyZW50KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0N1c3RvbWVyUmV2aWV3cycpXG4gICAgLmZhY3RvcnkoJ0N1c3RvbWVyUmV2aWV3cy5hcGknLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uICgkcmVzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnYXBpL2N1c3RvbWVyUmV2aWV3cycsIHt9LCB7XG4gICAgICAgICAgICBzZWFyY2g6IHsgbWV0aG9kOiAnUE9TVCcsIHVybDogJ2FwaS9jdXN0b21lclJldmlld3Mvc2VhcmNoJyB9LFxuICAgICAgICAgICAgdXBkYXRlOiB7IG1ldGhvZDogJ1BVVCcgfVxuICAgICAgICB9KTtcbiAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQ3VzdG9tZXJSZXZpZXdzJylcbiAgICAuY29udHJvbGxlcignQ3VzdG9tZXJSZXZpZXdzLmN1c3RvbWVyUmV2aWV3UG9zaXRpdmVXaWRnZXRDb250cm9sbGVyJywgWyckc2NvcGUnLCAnQ3VzdG9tZXJSZXZpZXdzLmFwaScsICdwbGF0Zm9ybVdlYkFwcC5ibGFkZU5hdmlnYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgcmV2aWV3c0FwaSwgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSkge1xuICAgICAgICB2YXIgYmxhZGUgPSAkc2NvcGUuYmxhZGU7XG4gICAgICAgIHZhciBmaWx0ZXIgPSB7IHRha2U6IDAsIG1pblN0YXJzOiAzIH07XG5cbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldmlld3NBcGkuc2VhcmNoKGZpbHRlciwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbENvdW50ID0gZGF0YS50b3RhbENvdW50O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUub3BlbkJsYWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nIHx8ICEkc2NvcGUudG90YWxDb3VudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBuZXdCbGFkZSA9IHtcbiAgICAgICAgICAgICAgICBpZDogXCJyZXZpZXdzTGlzdFwiLFxuICAgICAgICAgICAgICAgIGZpbHRlcjogZmlsdGVyLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAnQ3VzdG9tZXIgcmV2aWV3cyBmb3IgXCInICsgYmxhZGUudGl0bGUgKyAnXCInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDdXN0b21lclJldmlld3MucmV2aWV3c0xpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJ01vZHVsZXMvJChDdXN0b21lclJldmlld3MpL1NjcmlwdHMvYmxhZGVzL3Jldmlld3MtbGlzdC50cGwuaHRtbCdcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goXCJibGFkZS5pdGVtSWRcIiwgZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICBmaWx0ZXIucHJvZHVjdElkcyA9IFtpZF07XG5cbiAgICAgICAgICAgIGlmIChpZCkgcmVmcmVzaCgpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQ3VzdG9tZXJSZXZpZXdzJylcbiAgICAuY29udHJvbGxlcignQ3VzdG9tZXJSZXZpZXdzLmN1c3RvbWVyUmV2aWV3V2lkZ2V0Q29udHJvbGxlcicsIFsnJHNjb3BlJywgJ0N1c3RvbWVyUmV2aWV3cy5hcGknLCAncGxhdGZvcm1XZWJBcHAuYmxhZGVOYXZpZ2F0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsIHJldmlld3NBcGksIGJsYWRlTmF2aWdhdGlvblNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGJsYWRlID0gJHNjb3BlLmJsYWRlO1xuICAgICAgICB2YXIgZmlsdGVyID0geyB0YWtlOiAwIH07XG5cbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldmlld3NBcGkuc2VhcmNoKGZpbHRlciwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS50b3RhbENvdW50ID0gZGF0YS50b3RhbENvdW50O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUub3BlbkJsYWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nIHx8ICEkc2NvcGUudG90YWxDb3VudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBuZXdCbGFkZSA9IHtcbiAgICAgICAgICAgICAgICBpZDogXCJyZXZpZXdzTGlzdFwiLFxuICAgICAgICAgICAgICAgIGZpbHRlcjogZmlsdGVyLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAnQ3VzdG9tZXIgcmV2aWV3cyBmb3IgXCInICsgYmxhZGUudGl0bGUgKyAnXCInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDdXN0b21lclJldmlld3MucmV2aWV3c0xpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJ01vZHVsZXMvJChDdXN0b21lclJldmlld3MpL1NjcmlwdHMvYmxhZGVzL3Jldmlld3MtbGlzdC50cGwuaHRtbCdcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNob3dCbGFkZShuZXdCbGFkZSwgYmxhZGUpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goXCJibGFkZS5pdGVtSWRcIiwgZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICBmaWx0ZXIucHJvZHVjdElkcyA9IFtpZF07XG5cbiAgICAgICAgICAgIGlmIChpZCkgcmVmcmVzaCgpO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG4iXSwic291cmNlUm9vdCI6IiJ9